@import './components/FontFaces.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  font-family: system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  color: rgba(255, 255, 255, 0.87);
  background-color: #242424;

  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

a {
  font-weight: 500;
  color: #646cff;
  text-decoration: inherit;
}
a:hover {
  color: #535bf2;
}

body {
  background-color: var(--color-cardBg);
  color: var(--color-text);
  font-family: var(--font-body);
}

h1,h2,h3,h4,h5,h6 {
  font-family: var(--font-header);
}

/* Headings and text rhythm */
h1 { font-size: 1.5rem; line-height: 2rem; }
h2 { font-size: 1.125rem; line-height: 1.75rem; }
.muted { color: color-mix(in oklab, var(--color-text) 60%, transparent); }

/* Custom utilities mapping to CSS variables to avoid Tailwind token config */
.text-text { color: var(--color-text); }
.border-secondary { border-color: var(--color-secondary); }
.border-secondary-30 { border-color: color-mix(in oklab, var(--color-secondary) 30%, transparent); }
.border-secondary-40 { border-color: color-mix(in oklab, var(--color-secondary) 40%, transparent); }

/* Card element-level CSS variable consumption (with theme fallbacks) */
.card {
  background-color: var(--card-bg, var(--color-cardBg));
  color: var(--card-text, var(--color-text));
  font-family: var(--card-font, var(--font-body));
  grid-column: span var(--card-columns, 1);
  grid-row: span var(--card-rows, 1);
  border-radius: var(--card-radius, 0);
  box-shadow: var(--card-shadow, none);
}

/* Button element-level CSS variable consumption */
.button {
  background-color: var(--btn-bg, var(--color-primary));
  color: var(--btn-text, var(--color-text));
}

.preview-body {
  font-family: var(--font-preview-body, var(--font-body));
}
.preview-header {
  font-family: var(--font-preview-header, var(--font-header));
}
/* Generic preview; preview instances can set --font-preview-{id}, default falls back to body */
.preview {
  font-family: var(--font-preview-default, var(--font-body));
}

/* ===== Compatibility Fixes (prefixes + safe animations) ===== */

/* Text zoom behavior (Chrome/Edge/Safari/iOS) */
html, :root {
  text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}

/* Safari: backdrop-filter needs webkit prefix */
.modal-backdrop,
.backdrop-blur-fix {
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
}

/* Safari: user-select needs webkit prefix */
.select-none, .select-none-fix { -webkit-user-select: none; user-select: none; }
.select-text, .select-text-fix { -webkit-user-select: text; user-select: text; }
.select-auto, .select-auto-fix { -webkit-user-select: auto; user-select: auto; }

/* Safe, non-layout animations (no width/height/left/top) */
@keyframes fade-in { from { opacity: 0 } to { opacity: 1 } }
@keyframes scale-in { from { opacity: 0; transform: scale(.98) } to { opacity: 1; transform: scale(1) } }

.animate-fade-in { animation: fade-in .18s ease-out both; }
.animate-scale-in { animation: scale-in .18s ease-out both; }
